/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞
 */

/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
 * @param {Object} bot - –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
 * @param {Object} msg - –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
 */
const handleStart = (bot, msg) => {
  const chatId = msg.chat.id;
  const userName = msg.from.first_name || '–î—Ä—É–≥';
  
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º menuService –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é
  const menuService = require('../services/menuService');
  const ASSISTANTS = require('../config/assistants');
  
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–µ–π—Å–∞
  bot.sendMessage(
    chatId,
    `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ LeetCase! üöÄ
–°–µ–π—á–∞—Å –Ω–∞—á–Ω–µ—Ç—Å—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Ç–≤–æ–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã—Ö –Ω–∞–≤—ã–∫–æ–≤, –∫–æ—Ç–æ—Ä–∞—è —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –±–ª–æ–∫–æ–≤:

üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ 
üåê –°—Ç—Ä–∞—Ç–µ–≥–∏—è
ü§ù Soft Skills 
üöÄ Product Sense 
üß© –ë—Ä–µ–π–Ω—Ç–∏–∑–µ—Ä—ã 

–í –∫–∞–∂–¥–æ–º –±–ª–æ–∫–µ —Ç–µ–±—è –∂–¥—É—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã –∏–∑ –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø—Ä–æ–¥–∞–∫—Ç–æ–≤. –¢–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –∏ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è PM –≤ –≤–µ–¥—É—â–∏—Ö –∫–æ–º–ø–∞–Ω–∏—è—Ö.

üéôÔ∏è –¢—ã –º–æ–∂–µ—à—å –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è! –ü—Ä–æ—Å—Ç–æ –∑–∞–ø–∏—à–∏ –∞—É–¥–∏–æ, –∏ —è —Ä–∞—Å–ø–æ–∑–Ω–∞—é —Ç–≤–æ—é —Ä–µ—á—å.

–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ç—ã –ø–æ–ª—É—á–∏—à—å:

–û—Ü–µ–Ω–∫—É —Ç–≤–æ–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é –Ω–∞–≤—ã–∫–æ–≤
–ü–æ–¥–±–æ—Ä–∫—É –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è–º

–ì–æ—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–∏ —Å–∏–ª—ã –≤ —Ä–µ—à–µ–Ω–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã—Ö –∑–∞–¥–∞—á? 
–ü–æ–∫–∞–∂–∏, –Ω–∞ —á—Ç–æ —Ç—ã —Å–ø–æ—Å–æ–±–µ–Ω! üí™`,
    {
      reply_markup: {
        inline_keyboard: [
          [{ text: 'üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞', callback_data: 'category_üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞' }],
          [{ text: 'üåê –°—Ç—Ä–∞—Ç–µ–≥–∏—è', callback_data: 'category_üåê –°—Ç—Ä–∞—Ç–µ–≥–∏—è' }],
          [{ text: 'ü§ù Soft Skills', callback_data: 'category_ü§ù Soft Skills' }],
          [{ text: 'üöÄ Product Sense', callback_data: 'category_üöÄ Product Sense' }],
          [{ text: 'üß© –ë—Ä–µ–π–Ω—Ç–∏–∑–µ—Ä—ã', callback_data: 'category_üß© –ë—Ä–µ–π–Ω—Ç–∏–∑–µ—Ä—ã' }]
        ]
      }
    }
  );
  
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é
  menuService.sendMainMenuMessage(bot, chatId, '–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã:');
};

/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help
 * @param {Object} bot - –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
 * @param {Object} msg - –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
 */
const handleHelp = (bot, msg) => {
  const chatId = msg.chat.id;
  
  bot.sendMessage(
    chatId,
    `–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥:

/start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
/help - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
/info - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ
/case - –í—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∫–µ–π—Å–∞ –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –∏–Ω—Ç–µ—Ä–≤—å—é
/end - –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é —Å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º
/ai [–≤–æ–ø—Ä–æ—Å] - –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É
/subscribe - –û—Ñ–æ—Ä–º–∏—Ç—å –ø—Ä–µ–º–∏—É–º-–ø–æ–¥–ø–∏—Å–∫—É
/status - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏

–ë–µ—Å–ø–ª–∞—Ç–Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 3 –∑–∞–ø—Ä–æ—Å–∞. –î–ª—è –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –æ—Ñ–æ—Ä–º–∏—Ç–µ –ø—Ä–µ–º–∏—É–º-–ø–æ–¥–ø–∏—Å–∫—É –∑–∞ $29.

–¢–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∏ —è –æ—Ç–≤–µ—á—É —Å –ø–æ–º–æ—â—å—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞.

–ï—Å–ª–∏ —É –≤–∞—Å –∞–∫—Ç–∏–≤–Ω–∞ —Å–µ—Å—Å–∏—è —Å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –ø–æ –∫–µ–π—Å–∞–º, –≤—Å–µ –≤–∞—à–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã —ç—Ç–æ–º—É –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É.`
  );
};

/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /info
 * @param {Object} bot - –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
 * @param {Object} msg - –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
 */
const handleInfo = (bot, msg) => {
  const chatId = msg.chat.id;
  
  bot.sendMessage(
    chatId,
    `–≠—Ç–æ—Ç –±–æ—Ç –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å –ø–æ–º–æ—â—å—é Node.js –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ node-telegram-bot-api.

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç OpenAI API (GPT-4o) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.
–î–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –∏–Ω—Ç–µ—Ä–≤—å—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OpenAI Assistants API.

–ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ 3 –∑–∞–ø—Ä–æ—Å–∞. –î–ª—è –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –æ—Ñ–æ—Ä–º–∏—Ç–µ –ø—Ä–µ–º–∏—É–º-–ø–æ–¥–ø–∏—Å–∫—É –∑–∞ $29.

–í–µ—Ä—Å–∏—è: 1.3.0
–ê–≤—Ç–æ—Ä: –ö–∞–ª—ã –°–∞–º–∞–Ω–±–µ–∫–æ–≤`
  );
};

/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /reset
 * @param {Object} bot - –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
 * @param {Object} msg - –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
 */
const handleReset = (bot, msg) => {
  const chatId = msg.chat.id;
  
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–±—Ä–æ—Å–µ
  bot.sendMessage(
    chatId,
    `–°–±—Ä–∞—Å—ã–≤–∞—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –æ–±–Ω–æ–≤–ª—è—é –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...`
  ).then(() => {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    const caseHandlers = require('./caseHandlers');
    caseHandlers.sendCategoriesList(bot, chatId);
  });
};

module.exports = {
  handleStart,
  handleHelp,
  handleInfo,
  handleReset
};
