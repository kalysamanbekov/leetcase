/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞
 */

/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
 * @param {Object} bot - –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
 * @param {Object} msg - –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
 */
const handleStart = (bot, msg) => {
  const chatId = msg.chat.id;
  const userName = msg.from.first_name || '–î—Ä—É–≥';
  
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º menuService –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é
  const menuService = require('../services/menuService');
  const ASSISTANTS = require('../config/assistants');
  
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–µ–π—Å–∞
  bot.sendMessage(
    chatId,
    `üëã –ü—Ä–∏–≤–µ—Ç! –Ø LeetCase ‚Äî —Ç–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –≤ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–º –∏–Ω—Ç–µ—Ä–≤—å—é.

–í —Ç–æ–ø–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã—Ö-–∫–æ–º–ø–∞–Ω–∏—è—Ö –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è—Ö –ø—Ä–æ–≤–µ—Ä—è—é—Ç 5 –∫–ª—é—á–µ–≤—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è:
 
üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏, —Ä–∞—Å—á–µ—Ç—ã, –º–µ—Ç—Ä–∏–∫–∏
üß† –°—Ç—Ä–∞—Ç–µ–≥–∏—è ‚Äî —Ä–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞, –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π 
ü§ù Soft Skills ‚Äî –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è, –ª–∏–¥–µ—Ä—Å—Ç–≤–æ, —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–º–∞–Ω–¥–æ–π
üîç Product Sense ‚Äî –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–µ –º—ã—à–ª–µ–Ω–∏–µ 
üß© –ë—Ä–µ–π–Ω—Ç–∏–∑–µ—Ä—ã ‚Äî –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏ –∏ –æ—Ü–µ–Ω–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏`,
    {
      reply_markup: {
        inline_keyboard: [
          [{ text: '–î–∞–ª—å—à–µ', callback_data: 'next' }]
        ]
      }
    }
  );
  
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é
  menuService.sendMainMenuMessage(bot, chatId, '–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã:');
};

/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help
 * @param {Object} bot - –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
 * @param {Object} msg - –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
 */
const handleHelp = (bot, msg) => {
  const chatId = msg.chat.id;
  
  bot.sendMessage(
    chatId,
    `–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥:

/start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
/help - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
/info - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ
/case - –í—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∫–µ–π—Å–∞ –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –∏–Ω—Ç–µ—Ä–≤—å—é
/end - –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é —Å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º
/ai [–≤–æ–ø—Ä–æ—Å] - –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É
/subscribe - –û—Ñ–æ—Ä–º–∏—Ç—å –ø—Ä–µ–º–∏—É–º-–ø–æ–¥–ø–∏—Å–∫—É
/status - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏

–ë–µ—Å–ø–ª–∞—Ç–Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 3 –∑–∞–ø—Ä–æ—Å–∞. –î–ª—è –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –æ—Ñ–æ—Ä–º–∏—Ç–µ –ø—Ä–µ–º–∏—É–º-–ø–æ–¥–ø–∏—Å–∫—É –∑–∞ $29.

–¢–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∏ —è –æ—Ç–≤–µ—á—É —Å –ø–æ–º–æ—â—å—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞.

–ï—Å–ª–∏ —É –≤–∞—Å –∞–∫—Ç–∏–≤–Ω–∞ —Å–µ—Å—Å–∏—è —Å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –ø–æ –∫–µ–π—Å–∞–º, –≤—Å–µ –≤–∞—à–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã —ç—Ç–æ–º—É –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É.`
  );
};

/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /info
 * @param {Object} bot - –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
 * @param {Object} msg - –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
 */
const handleInfo = (bot, msg) => {
  const chatId = msg.chat.id;
  
  bot.sendMessage(
    chatId,
    `–≠—Ç–æ—Ç –±–æ—Ç –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å –ø–æ–º–æ—â—å—é Node.js –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ node-telegram-bot-api.

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç OpenAI API (GPT-4o) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.
–î–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –∏–Ω—Ç–µ—Ä–≤—å—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OpenAI Assistants API.

–ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ 3 –∑–∞–ø—Ä–æ—Å–∞. –î–ª—è –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –æ—Ñ–æ—Ä–º–∏—Ç–µ –ø—Ä–µ–º–∏—É–º-–ø–æ–¥–ø–∏—Å–∫—É –∑–∞ $29.

–í–µ—Ä—Å–∏—è: 1.3.0
–ê–≤—Ç–æ—Ä: –ö–∞–ª—ã –°–∞–º–∞–Ω–±–µ–∫–æ–≤`
  );
};

/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /reset
 * @param {Object} bot - –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
 * @param {Object} msg - –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
 */
const handleReset = (bot, msg) => {
  const chatId = msg.chat.id;
  
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–±—Ä–æ—Å–µ
  bot.sendMessage(
    chatId,
    `–°–±—Ä–∞—Å—ã–≤–∞—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –æ–±–Ω–æ–≤–ª—è—é –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...`
  ).then(() => {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    const caseHandlers = require('./caseHandlers');
    caseHandlers.sendCategoriesList(bot, chatId);
  });
};

module.exports = {
  handleStart,
  handleHelp,
  handleInfo,
  handleReset
};
