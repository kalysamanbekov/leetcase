# Telegram Bot

Это Telegram бот с ограничением триального доступа, разработанный на Node.js с использованием библиотеки node-telegram-bot-api и интеграцией с OpenAI API.

## Функциональность

- Обработка команд (/start, /help, /info, /status, /subscribe)
- Обработка текстовых сообщений с помощью OpenAI API
- Работа с кейсами для подготовки к интервью (/case)
- Система триального доступа с ограничением количества бесплатных запросов
- Премиум-подписка через сервис Трибут
- Административные функции для управления пользователями

## Установка

1. Клонируйте репозиторий
2. Установите зависимости: `npm install`
3. Создайте файл `.env` и добавьте в него необходимые переменные окружения:
   ```
   TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
   OPENAI_API_KEY=your_openai_api_key_here
   NODE_ENV=development
   ```

## Запуск

Для локального запуска бота выполните:

```bash
npm start
```

Для разработки с автоматической перезагрузкой при изменении кода:

```bash
npm run dev
```

## Получение токенов

### Telegram Bot Token
1. Откройте Telegram и найдите @BotFather
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания нового бота
4. Получите токен и добавьте его в файл `.env`

### OpenAI API Key
1. Зарегистрируйтесь на [OpenAI Platform](https://platform.openai.com/)
2. Перейдите в раздел API keys
3. Создайте новый ключ API
4. Добавьте его в файл `.env`

## Развертывание на Render

Для развертывания бота на Render выполните следующие шаги:

1. Создайте аккаунт на [Render](https://render.com/)
2. Нажмите на кнопку 'New +' и выберите 'Web Service'
3. Подключите свой репозиторий GitHub/GitLab
4. Настройте сервис:
   - **Name**: telegram-bot (или любое другое имя)
   - **Environment**: Node
   - **Build Command**: `npm install`
   - **Start Command**: `npm start`
5. Добавьте переменные окружения:
   - `TELEGRAM_BOT_TOKEN`
   - `OPENAI_API_KEY`
6. Нажмите 'Create Web Service'

Render автоматически развернет ваш бот и будет поддерживать его работу 24/7. При каждом коммите в репозиторий Render автоматически обновит развернутое приложение.

## Сценарии взаимодействия с пользователем

### Основные команды
- `/start` - Начало работы с ботом
- `/help` - Получение справки о командах
- `/info` - Информация о боте
- `/status` - Проверка статуса подписки
- `/subscribe` - Информация о премиум-подписке
- `/case` - Работа с кейсами для подготовки к интервью
- `/end` - Завершение текущей сессии с кейсом
- `/ai [вопрос]` - Прямой запрос к AI с параметрами

### Ограничение триального доступа
Бот предоставляет ограниченное количество бесплатных запросов (по умолчанию 3). После исчерпания лимита пользователю предлагается оформить премиум-подписку через сервис Трибут.u0438 u0438u0437u043cu0435u043du0435u043du0438u0438 u043au043eu0434u0430, u0434u043eu0431u0430u0432u044cu0442u0435 u0432 `package.json` u0441u043bu0435u0434u0443u044eu0449u0438u0435 u0441u043au0440u0438u043fu0442u044b:

```json
"scripts": {
  "start": "node src/index.js",
  "dev": "nodemon src/index.js"
}
```

u0417u0430u0442u0435u043c u0437u0430u043fu0443u0441u0442u0438u0442u0435 u0431u043eu0442 u0432 u0440u0435u0436u0438u043cu0435 u0440u0430u0437u0440u0430u0431u043eu0442u043au0438:

```bash
npm run dev
```
